## 1. 方案

### （1）磁盘分区策略  
- **分区构成**：  
  - **热点区**：分为热点1区和热点2区，分别由两个磁头管辖。  
  - **冗余区**：作为热点去和备份区之间的补充区域，应对热点区或备份区数据溢出的异常状况。  
  - **冷数据区（备份区）**：存放文件副本的部分，约占总区域的 2/3，无读取操作。  
- **热点区细分 tag 区**：  
  - 按照每个 tag 的预估最大占用空间，将热点区进一步划分为若干 tag 区，区域大小需进一步调整。  
  - 按 tag 之间归一化后的读取频率相似度排列各分区。

### （2）写入策略  

- **磁盘选择**：  

  - 轮流在各个磁盘的热点1区和热点2区中写入。  
  - 轮流在其他磁盘的备份区写入。  

- **tag 区域选择顺序**：  

  1. 优先写入能够最佳碎片匹配的对应 tag 区。
  2. 若没有最佳匹配，选择空闲区域能够写入的对应的 tag 区。  
  2. 若当前 tag 区满，则反向写入到相邻 tag 区。  
  3. 若相邻 tag 区已满，则依次选取读取频率最近的区域。  
  4. 均无空闲空间，则写入到冗余区中。

- **反向写入机制**：

  - 相邻 tag 区采用对向写入（一个顺时针写入，另一个逆时针写入），空间更加动态。
  - 当前 tag 区已满时，反向写入到其他 tag 区。

### （3）读取策略  

- **磁头调度**：  

  - 每个磁头按照最优"rpj序列"（即以最低 token 消耗的顺序）单向顺序读取所负责区域内的数据。
  
### （4）Busy（过载）策略  

- **前置过滤**：  

  - 在请求加入前，根据前若干个请求的平均等待时间，丢弃当前读取频率最低的 m 个 tag 的请求。
  - 特殊的，如请求的对象已经存在其它请求或其所在的磁盘块附近存在请求，则保留请求。

- **后置过滤**：  

  - 读取后，维护请求队列，抛弃周期达到 104 的请求。

### （5）GC 策略  

采用多级GC机制，包括一对多交换、多对多交换和分区内聚拢三个层次。

- **一对多交换（S2M）**：
  - 在不同分区间寻找大小匹配的对象组合。
  - 支持两种模式：
    1. 纯对象交换：一个大对象与多个小对象直接交换。
    2. 引入空闲块：允许使用空闲块填充大小差异。
  - 优先选择最佳匹配的空闲区或对象组合。

- **多对多交换（M2M）**：
  - 使用动态规划算法在不同分区间寻找大小总和相等的对象组合。
  - 通过多对多交换实现更灵活的对象迁移。

- **分区内聚拢**：
  - 采用双向聚拢策略：
    1. 不分割对象模式：保持对象完整性进行移动。
    2. 分割对象模式：允许对象分割以实现更紧凑的布局。
  - 优先处理空闲块和其他分区对象。
  - 通过最佳匹配算法减少碎片。

- **执行顺序**：
  1. 优先处理当前读取频率高的分区。
  2. 执行一对多交换（不含空闲块）。
  3. 执行一对多交换（含空闲块）。
  4. 执行多对多交换。
  5. 执行分区内聚拢。
